# Living Style Guide for AMA
This is the living style guide for the American Medical Association. It is a platform-agnostic tool to empower employees and vendors to maintain consistent design and hierarchy throughout the AMA digital ecosystem.

This style guide is a compilation of [atomic components](http://bradfrost.com/blog/post/atomic-web-design/) that have been specifically tailored to the needs of AMA. By documenting and assembling this collection of patterns, we are able to build consistently, reuse code, and [see all of our patterns in one place](https://americanmedicalassociation.github.io/AMA-style-guide/).

## Style Guide Consumers - To use the Style Guide on a project:
- Grab the [latest release](https://github.com/AmericanMedicalAssociation/AMA-style-guide/releases)
- Open the `.zip` into your project
- Link to the production files at `assets/`

## Style Guide Developers - To begin working:

**Environment setup (mac)**

 - Have [`homebrew`](https://brew.sh/) installed
 - `brew install nvm`
 - `nvm install v7.10.0` (or some relatively recent node version. Note 8.0.0 has a fatal bug with require-dir module)
 - `nvm use 7.10.0`

**Just the first time:**

- `cd styleguide`
- `composer install`
- `npm install`
- `sudo npm install -g gulp`
  - This will install gulp globally on your machine. If you don't have privileges, don't want to install globally, or need to manage multiple projects using `gulp`, you can invoke `gulp` via `./node_modules/.bin/gulp serve` instead of directly.

**For ongoing development**

- `gulp serve` to watch files and display the resulting page in your local browser.
- Occasionally things might stop refreshing well. If that happens, just kill (`Control-C`) gulp and re-run.
- `gulp scss-lint` will check your SCSS for code quality. Please ensure your code lints successfully. A few notes:
  - We're using autoprefixer to get all the latest and greatest vendor prefixes. You should not need to use vendor prefixes in your code.
  - If you do need a vendor prefix (for device-specific changes, like `-webkit-appearance`) you can [disable linting for those lines](https://github.com/stylelint/stylelint/blob/master/docs/user-guide/configuration.md#turning-rules-off-from-within-your-css).
- CSS sourcemaps are generated by gulp so you can see what files are generating the applicable css for each element. If you are seeing something like "style.css?123456789" when you inspect elements in your browser, check that you have "enabled CSS mapping" in your dev tools. [Chrome's developer documentation shows how to check your settings.](https://developers.google.com/web/tools/chrome-devtools/javascript/source-maps#enable_source_maps_in_settings)
- Javascript files in the style guide require special consideration. Please read [the documentation](styleguide/docs/code_conventions.md#javascript) before writing new JS.

## Project Branches

The style guide project maintains a number of branches:

- `develop` - the (uncompiled) working branch
- `gh-pages` - the compiled, publicly accessible “production” artifact
- `dev-assets` - the compiled, Drupal-consumed artifact for testing
- `master` - the compiled production release that gets tagged.

For more detail on how to deploy to these branches, see [Creating a Release](styleguide/docs/creating_a_release.md)

## Troubleshooting:
### Make sure your npm dependencies are up to date
If you run unto an unexpected error, you might just be missing a dependency

- Run `npm install` from the `styleguide` directory to grab any missing dependencies.

### Make sure node and npm are up to date(-ish)
You might have to do any or all of these

- Update node

```
sudo npm cache clean -f
sudo npm install -g n
sudo n stable
```

- Update npm

```
sudo npm install -g npm
```

- Rebuild npm to recompile any outdated packages.

```
npm rebuild
```

## What's going on here?
### Icons
Icons are being generated using [Grunticon](https://github.com/filamentgroup/grunticon) with the [Gulpicon](https://github.com/filamentgroup/gulpicon) wrapper. This generates a three-tier system of fallbacks, which are controlled by a JS-based loader [full desc](https://github.com/filamentgroup/grunticon#a-mystical-css-icon-solution).

New icons can be places in `source/assets/icons/svg`. When `gulp icons` is run, the process will [minify the SVGs](https://www.npmjs.com/package/gulp-svgmin) then run `gulpicon` using the config and template in the icons directory, finally outputting everything in `public/assets/icons/`. The loader and initialization code are in [`_00-head.twig`](./styleguide/source/_meta/_00-head.twig).

### Responsive implementation
We are using [Breakpoint](http://breakpoint-sass.com/) to handle media queries for responsive implementation.

The first time you run `npm install` the dependency will be installed, but if you run into an error, running `npm install` again should fix the issue.
